<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/Layout"
layout:decorate="@{layout/default_qualityControl}">

<th:block layout:fragment="pageTitle">
	   <div class="border-head"> 
	    <h3>품질 관리</h3>
	    </div>
</th:block>


<th:block layout:fragment="container">
    
<div class="col-lg-12 mt">
            <div class="row content-panel">
              <div class="panel-heading">
                <ul class="nav nav-tabs nav-justified">
                  <li class="active">
                    <a data-toggle="tab" href="#overview">원부자재 측정값 등록</a>
                  </li>
                  <li>
                    <a data-toggle="tab" href="#contact">수치별로 등록</a>
                  </li>
                  <li>
                    <a data-toggle="tab" href="#edit">합격/불합격별로 등록</a>
                  </li>
                </ul>
              </div>
              <!-- /panel-heading -->
              <div class="panel-body">
                <div class="tab-content">
                  <div id="overview" class="tab-pane active">
               
                <div class="form-inline">
              		<div class="col-sm-3 input-group">	
						<input type="text" class="form-control" placeholder="품질검사 요청코드 검색">
						<div class="input-group-btn">
							<button id="requestCode" class="btn btn-warning">검색</button>
						</div>
					</div>
	                <div class="col-sm-3 input-group">	
						<input type="number" id="trCount" min="1" value="1" class="form-control" placeholder="숫자입력">
						<div class="input-group-btn">
							<button id="addRows" class=" btn btn-theme03 btn btn-default">측정값 행 추가</button>
						</div>
					</div>	                
                </div>
				<br>
                 <table class="table table-bordered table-striped table-condensed">
                  <thead>
                    <tr ><!-- 세부에 체크가 되어있으면 세부에 값이 들어간다...? -->
                      <th><input type="checkbox" id="checkAll"></th>
                      <th>*품질검사 요청코드</th>
                      <th>검사명</th>
                      <th>원부자재명</th>
                      <th>
                      	*측정홧수
                      </th>
                      <th>
                      	측정값
                      </th>
   					  <th>
   					  	단위
   					  </th>
   					  <th>
                      	시작일시
                      </th>
                      <th>
                      	완료일시
                      </th>
                      <th>
                      	등록
                      </th>
                      <th>
                      	삭제
                      </th>
                    
                    </tr>
                  </thead>
                  <tbody id="tbody">
                    <tr id="tableTr">	
                      <td><input type="checkbox" class="checked"></td>
                      <td>
		                <div class="input-group">	
							<input type="text" class="form-control" placeholder="숫자입력">
							<div class="input-group-btn">
								<button id="addRows" class="btn btn-default">검색</button>
							</div>						
		                </div>
					  </td>
					  <td>검사명</td>
					  <td>원부자재이름</td>
                      <td>
					      <select class="form-control">
					      	<option>1회차</option>
					      	<option>2회차</option>
					      	<option>3회차</option>
					      </select>
					  </td>
                      <td>
                      	<input type="number" class="form-control" placeholder="측정값">                      	
					  </td>
                      <td>
                      	<select class="form-control">
					      	<option>mm</option>
					      	<option>cm</option>
					      	<option>직접입력</option>
					      </select>         	
					  </td>
                      <td>
                      	<input type="text" class="form-control" placeholder="공란일시 등록시간">
                      </td>
                      <td>
                      	<input type="text" class="form-control" placeholder="공란일시 등록시간">
                      </td>
                      <td>
	               		<button type="button">등록</button>
					  </td>
                      <td>
	               		<button type="button" class="removeButton">삭제</button>
					  </td>
                    </tr>

                  </tbody>
                </table>  
                 
              <div class="form-group text-right">
                    <div class="col-lg-offset-2 col-lg-10">
                      <a href="#" class="btn btn-success btn-xs"><i class="fa fa-check"></i>등록</a>
                      <a class="btn btn-danger btn-xs" id="deleteBtn"><i class="fa fa-trash-o "></i>삭제</a>
                    </div>
                </div>
                
                <!-- 등급별로 등록 -->
               </div>


                <!-- 두번째 -->
                  <div id="contact" class="tab-pane">
                  	<th:block th:replace="/quality/addInspectionMeasurementValueMenu/addInspectionMeasurementValueSubSize::subSize"></th:block>
                  </div>
                  
                  
                  <!-- 세번째 -->
                  <div id="edit" class="tab-pane">
                  	<th:block th:replace="/quality/addInspectionMeasurementValueMenu/addInspectionMeasurementValueSubPass::subPass"></th:block>
                  </div>
                  
                  
                  <!-- /tab-pane -->
                </div>
                <!-- /tab-content -->
              </div>
              <!-- /panel-body -->
            </div>
            <!-- /col-lg-12 -->
          </div>
          
          
          <!-- 모달시작 -->
          <div class="modal fade modal-xl"  id="requestCodeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog" style="width:auto;display:table" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h4 class="modal-title" id="exampleModalLabel">발주 목록 검색</h4>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      
		   
		   <div class="modal-body">
		   
		   <table  class="table table-striped table-advance table-hover">
         	<tbody>       		
       			<thead>
        			<tr>
	         			<th colspan="3" style="padding-right: 20px;">
		         			 <div class="form-inline" style="margin-bottom: 0px;">
		         			 	<label class="control-label">발주 코드</label>&nbsp
			                	<input type="text" class="form-control" id="bySupplierValue" placeholder="검색어를 입력하세요.">
			                </div>
	         			</th>
	         			<th colspan="2" style="padding-right: 20px;">
	         				<div class="form-inline" style="margin-bottom: 0px;">
		         				<label class="control-label">거래처명</label>&nbsp
			                	<input type="text" class="form-control" id="exampleInputPassword2" placeholder="검색어를 입력하세요.">
		              		</div>
	         			</th>  
	         			<th colspan="2" style="padding-right: 20px;">
	         				<div class="form-inline" style="margin-bottom: 0px;">
		         				<label class="control-label">품목명</label>&nbsp
			                	<input type="text" class="form-control" id="exampleInputPassword2" placeholder="검색어를 입력하세요.">
		              		</div>
	         			</th>  
	         			<th colspan="5" style="padding-right: 20px;">
	         				<div class="form-inline" style="margin-bottom: 0px;">
		         				<label class="control-label">발주 날짜</label>&nbsp
			                	<input type="date" class="form-control" id="exampleInputPassword2" placeholder="검색어를 입력하세요.">&nbsp ~
			                	<input type="date" class="form-control" id="exampleInputPassword2" placeholder="검색어를 입력하세요.">
	         				 &nbsp&nbsp&nbsp <button type="submit" class="btn btn-theme">검색</button>
		              		</div>
	         			</th>  
        			</tr>     			
       			</thead>
       			<tbody style="text-align: center;">
       				<tr>
       					<td><i class="fa fa-check"></i></td>
       					<td>no.</td>
       					<td>발주코드</td>
       					<td>원부자재 코드</td>
       					<td>거래처명</td>
       					<td>품목명</td>
       					<td>색상명</td>
       					<td>특징</td>
       					<td>수량</td>
       					<td>입고예정일</td>
       					<td>발주일자</td>
       				</tr>
     				<tr>

     				</tr>
     			</tbody>        		
         	</tbody>
         </table> 
         
		 </div>
		    <div class="modal-footer">
			      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			      <button type="button" id="saveSupplier" class="btn btn-primary" data-dismiss="modal">Save changes</button>
		      </div>
		    </div>
		  </div>
		</div>
          
          
<script>
	$(function(){	
		
		//새로고침 방지(새로고침하면 탭이 넘어가버려서 막아놓을까 생각중입니다.)
// 		function noEvent() { // 새로 고침 방지
// 		    if (event.keyCode == 116) {
// 		        alert("새로고침을 할 수 없습니다.");
// 		        event.keyCode = 2;
// 		        return false;
// 		    } else if (event.ctrlKey
// 		            && (event.keyCode == 78 || event.keyCode == 82)) {
// 		        return false;
// 		    }
// 		}
// 		document.onkeydown = noEvent;
		
		
		
		//모달 실행
		$(document).on('click', '#requestCode', function(){
			$('#requestCodeModal').modal("show");
		});
		
		// 전체 체크
		$(document).on('click', '#checkAll', function(){
			if($('#checkAll').prop('checked')){
				$('.checked').prop('checked',true);
			}else{
				$('.checked').prop('checked',false);
			}
		});
		
		// 체크된 행 삭제
		$(document).on('click', '#deleteBtn', function(){
			if (confirm("정말 삭제하시겠습니까?")) {
                // 확인 버튼 클릭 시 동작
				var checkObj = $('input[class="checked"]:checked');
				// 체크된 항목 수
				var checkCount = checkObj.length;
				// 전체 행의 수
				var bodyCount = $('#tbody tr').length;
				
				if(checkCount < 1){
					alert('체크된 항목이 없습니다.');
					return false;
				}
				
				if(checkCount >= bodyCount +2) {
					alert('모든 행을 지울 수 없습니다.');
					return false;
				}
			
				$.each(checkObj, function(){
					$(this).parent().parent().remove();
					$('#checkAll').prop('checked',false);
				});
				
				var lastTrRemoveBtnObj = $('#tbody tr:last td').find('.removeButton');
				
// 				lastTrRemoveBtnObj.attr('class', 'addButton');
// 				lastTrRemoveBtnObj.text('추가');
            } else {
                // 취소 버튼 클릭 시 동작
                alert("동작을 취소했습니다.");
            }
			
			
		});
		
		
		//행 추가
		$('#addRows').click(function(){
			var count = $('#trCount').val();
			var tbody = $('#tbody');
			
			if(count != null && count != undefined && count > 0){
// 				$('#tbody tr:last td:last button').attr('class', 'removeButton');
// 				$('#tbody tr:last td:last button').text('삭제');
				
				for(var i = 0; i < count; i++){
					var lastIndex = $(tbody).find('tr:last').length;
					var innerHtml = '<tr>';
					innerHtml += '<td><input type="checkbox" class="checked"></td>';
					innerHtml += '<td><div class="input-group"><input type="text" class="form-control" placeholder="숫자입력"><div class="input-group-btn"><button id="addRows" class="btn btn-default">검색</button></div></div></td>';
					innerHtml += '<td>검사명</td>';
					innerHtml += '<td>원부자재이름</td>';
					innerHtml += '<td><select class="form-control"><option>1회차</option><option>2회차</option><option>3회차</option></select></td>';
					innerHtml += '<td><input type="number" class="form-control" placeholder="측정값"></td>';
					innerHtml += '<td><select class="form-control"><option>mm</option><option>cm</option><option>직접입력</option></select></td>';
					innerHtml += '<td><input type="text" class="form-control" placeholder="공란일시 등록시간"></td>';
					innerHtml += '<td><input type="text" class="form-control" placeholder="공란일시 등록시간"></td>';
					innerHtml += '<td><button type="button">등록</button></td>';
					
					if(i == (count - 1)){
						innerHtml += '<td><button type="button" class="removeButton">삭제</button></td>';
					}else{
						innerHtml += '<td><button type="button" class="removeButton">삭제</button></td>';	
					}
					
					innerHtml += '</tr>';
					tbody.append(innerHtml);	
					
					
				}
			}else{
				alert('확인');
				$('#trCount').focus();
				return false;
			}
			$('#trCount').val(1);
			
		});
		
		
		
		//행 삭제
		$(document).on('click', '.removeButton', function(){
			var bodyCount = $('#tbody tr').length;
			
			if(bodyCount == 1) {
				alert('모든 행을 지울 수 없습니다.');
				return false;
			}
			
			else if (confirm("정말 삭제하시겠습니까?")) {
                // 확인 버튼 클릭 시 동작
				var tr = $(this).parent().parent();
				tr.remove();
            } else {
                // 취소 버튼 클릭 시 동작
                alert("동작을 취소했습니다.");
            }
			$('#addMemberBody tr:last td:last button').attr('class', 'addButton');
			$('#addMemberBody tr:last td:last button').text('삭제');
		});
		
	});
	
	
	
</script>
</th:block>

</html>