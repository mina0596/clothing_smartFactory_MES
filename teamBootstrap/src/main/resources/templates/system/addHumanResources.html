<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/Layout"
layout:decorate="@{layout/default_system}">

<th:block layout:fragment="pageTitle">
	   <div class="border-head"> 
	    <h3 th:text="${title}"></h3>
	    </div>
</th:block>

<th:block layout:fragment="customJs">
	<script>
		$(function(){
			$('#idCheckBtn').click(function(){
				var employeeId = $('input[name="employeeId"]').val();
				console.log('employeeId: ' + employeeId);

				if(employeeId != '' && employeeId != undefined && employeeId != null){
					var request = $.ajax({
						url: "/memberIdCheck",
						method: "POST", 
						data: { employeeId : employeeId }, 
						dataType: "json" 
					}); 
					request.done(function( data ) {
						if(data){
							$('#addEmployeeForm input').prop('disabled', false);
							$('#addEmployeeForm select').prop('disabled', false);
							$('#addEmployeeForm button').prop('disabled', false);
						}else{
							alert('중복된 아이디입니다.');
							$('input[name="employeeId"]').focus();
						}
						
					}); 
					request.fail(function( jqXHR, textStatus ) {
						alert( "Request failed: " + textStatus );
					});	
				}
				
			});
			
			$('#addEmployeeBtn').click(function(){
				var regexPw = /^.*(?=^.{2,8}$)(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&+=]).*$/;
				var regexEmail = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
				var submitFlag = true;
				var memberForm = $('#addEmployeeForm');
				var inputObj = memberForm.find('input');
				
				$.each(inputObj, function(e){
					var inputName = $(this).attr('name');
					var inputValue = $(this).val();
					var inputLabel = $(this).parent().parent().children().eq(0).text();
					if(inputName == 'memberPw'){
						if(!regexPw.test(inputValue)){
							alert(inputLabel + ' 을 다시 입력해주세요.');
							$(this).focus();
							submitFlag = false;
							return submitFlag;
						}
					}else if(inputName == 'memberEmail'){
						if(!regexEmail.test(inputValue)){
							alert(inputLabel + ' 을 다시 입력해주세요.');
							$(this).focus();
							submitFlag = false;
							return submitFlag;
						}
					}else{
						if(inputValue == '' || inputValue == undefined || inputValue == null){
							alert(inputLabel + ' 을 입력해주세요.');
							$(this).focus();
							submitFlag = false;
							return submitFlag;
						}
					}
				});
				
				if(submitFlag) memberForm.submit();
				
			});
		});
	</script>
</th:block>


<th:block layout:fragment="container">
	
	<div class="form-panel">
	 <h4 class="mb"><i class="fa fa-angle-right"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 사원등록</font></font></h4>
              <div class="form">
                <form class="cmxform form-horizontal style-form" id="addEmployeeForm" method="post"  th:action="@{/addHumanResources}">
       
	                <div class="form-group">
			          <label class="col-sm-2 col-sm-2 control-label" style="font-weight: 600;">아이디</label>
			          <div class="col-md-6">
			            <div  class="input-group ">
			              <input type="text" name = "employeeId" class="form-control"  size="16">
			              <div class="input-group-btn">
			                <button type="button" id="idCheckBtn" class="btn btn-warning"><i class="fa"></i>중복체크</button>
			              </div>
			            </div>
			          </div>
			        </div>
                  
                    <div class="form-group ">
                      <label for="password" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">패스워드</font></font></label>
                      <div class="col-lg-6">
                        <input class="form-control " name="employeePw" type="password">
                      </div>
                    </div>
                  
                    <div class="form-group ">
                     <label for="confirm_password" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">패스워드 확인</font></font></label>
                      <div class="col-lg-6">
                       <input class="form-control "  name="employeePwCheck" type="password" >
                      </div>
                    </div>
                  
                   <div class="form-group">
                    <label class="col-sm-2 col-sm-2 control-label" style="font-weight: 600;">권한</label>
                     <div class="col-sm-2">
                      <select class="form-control" name = "levelNum" >
						<option>::선택::</option>
						<option value="1">관리자</option>					
						<option value="2">본사직원</option>
						<option value="3">공장직원</option>
		               </select>
                     </div>
                    </div>
                    
                  <div class="form-group ">
                    <label for="firstname" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">사원명</font></font></label>
                     <div class="col-lg-6">
                      <input class=" form-control" name="employeeName" type="text" >
                     </div>
                  </div>
                  
                  <div class="form-group ">
                    <label for="email" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">이메일</font></font></label>
                    <div class="col-lg-6">
                      <input class="form-control " name="employeeEmail" type="text">
                    </div>
                  </div>
                  
                  <div class="form-group ">
                    <label for="email" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">전화번호</font></font></label>
                    <div class="col-lg-6">
                      <input class="form-control " name="employeeTel" type="text" >
                    </div>
                  </div>
                  
                  <div class="form-group ">
                    <label for="email" class="control-label col-lg-2" style="font-weight: 600;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">주소</font></font></label>
                    <div class="col-lg-6">
                      <input class="form-control " name="employeeAddress" type="text" >
                    </div>
                  </div>
              
                  <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label" style="font-weight: 600;">소속</label>
                  <div class="col-sm-2">
                      <select class="form-control"  name = "employeeDepartment">
						<option>::선택::</option>
						<option value = "본사">본사</option>
						<option value = "공장">공장</option>
		               </select>
                  </div>
                </div>
                
                  <div class="form-group">
                  <label class="col-sm-2 col-sm-2 control-label" style="font-weight: 600;">직책</label>
                  <div class="col-sm-2">
                      <select class="form-control" name = "employeePosition">
						<option>::선택::</option>
						<option value = "사원">사원</option>
						<option value = "주임">주임</option>
						<option value = "대리">대리</option>
						<option value = "과장">과장</option>
						<option value = "차장">차장</option>
						<option value = "부장">부장</option>
						<option value = "임원">임원</option>
		               </select>
                  </div>
                </div>
                
         <div class="form-group text-right">
          <div class="col-lg-offset-2 col-lg-10">
            <button class="btn btn-theme" type="submit" id="addEmployeeBtn"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">등록</font></font></button>
            <button class="btn btn-theme04" type="button" onClick="history.back();"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">취소</font></font></button>
          </div>
        </div>
      </form>
    </div>
 </div>


</th:block>

</html>
