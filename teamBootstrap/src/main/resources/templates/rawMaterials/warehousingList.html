<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
xmlns:layout="http://www.ultraq.net.nz/thymeleaf/Layout"
layout:decorate="@{layout/default_rawMaterials}">

<th:block layout:fragment="pageTitle">
	   <div class="border-head"> 
	    <h3>자재관리</h3>
	    </div>
</th:block>
<th:block layout:fragment="customJs">
	<script type="text/javascript">
		$(function(){
			
			//#checkAll 버튼 클릭 시 전체 checked
			$('#checkAll').click(function(){
				if($('#checkAll').prop('checked')){
					$('.checked').prop('checked',true);
				}else{
					$('.checked').prop('checked',false);
				}
			});									
			var tb = $('table');
			console.log(tb);
			var tableAttr = $('#list').children();
			console.log(tableAttr);
			var tdList = tableAttr.find('.check');
			
			//수정하기
			//전혀 먹히지가 않는다.......
			var modifyBtn = tableAttr.children().find('#modifyBtn');
			modifyBtn.click(function(){
				console.log('찍히니?');
				var tdElement = $(this).parent().parent();
				var inventoryCate = tdElement.find('#inventoryCate').text();
				console.log(rawMaterialCate);
				if(inventoryCate == '입고'){
					location.href='modifyInWarehousing';
				}
			});
		});
		
	</script>
</th:block>

<th:block layout:fragment="container">
	<div class="row mt">
     <div class="col-md-12">
          <h4><i class="fa fa-th"></i> 원부자재 출/입고 종합 조회</h4>
          <hr>  
			<div class="form-group" style="padding-left: 60px;">
				<div class="col-md-3">
				 <select class="form-control">
				   <option>원부자재코드</option>
				   <option>재료명</option>
				   <option>재료 색상명</option>
				   <option>단위</option>
				   <option>수량</option>
				   <option>최신업데이트 일자</option>
				  </select>
				</div>
				<div class="col-xs-3">
				  <input class="form-control col-xs-3" type="text" placeholder="검색어를 입력하세요">
				</div>
				<div class="col-xs-3">
               		<input type=date class="form-control col-xs-3" id="exampleInputPassword2" placeholder="입고일별">
				</div>
				<div class="col-md-2">         
				  <button type="button" class="btn btn-theme">검색</button>
				</div>
	       </div>
	       
	       
	               		
	       
	      <br>
	      <br>
	      <br>
	      <br>
	      <br>
	      
                
	        
              <table id="list" class="table table-striped table-advance table-hover">
                <thead>
                  <tr>
                 	<th><i class="fa fa-check-circle-o"></i> 선택</th>
             		<th><i class="fa fa-bullhorn"></i> 번호</th>
             		<th><i class="fa fa-clock-o"></i> 입/출고 일자</th>
             		<th><i class="fa fa-bookmark"></i> 입/출고 구분</th>
                    <th><i class="fa fa-barcode"></i> 원부자재 코드</th>
                    <th><i class="fa fa-bookmark"></i> 재료명</th>
                    <th><i class=" fa fa-bookmark"></i> 색상코드</th>
                    <th><i class=" fa fa-bookmark"></i> 수량</th>
                    <th><i class=" fa fa-bookmark"></i> 단위</th>
                    <th><i class=" fa fa-bookmark"></i> 발주주문코드</th>
                    <th><i class=" fa fa-exchange"></i> 입고/출고 등록</th>
                    <th><i class=" fa fa-pencil"></i> 수정</th>
                  </tr>
                </thead>
                <tbody>
                  <tr th:if="${#lists.size(inventoryList) > 0}" th:each="l,n : ${inventoryList}" class="gradeX" >
	                <td><input type="checkbox" class="check"></td>
	            	<td th:text="${n.index+1}"></td>
                    <td th:text="${l.transactionDate}"></td>
                    <td th:text="${l.transactionCate}" id="inventoryCate"></td>
                    <td th:text="${l.materialCode}"></td>
                    <td th:text="${l.materialsInfo.rawMaterialName}" id="materialName"></td>
                    <td th:text="${l.materialsInfo.colorCode}" id="colorName"></td>
                    <td th:text="${l.transactionAmount}"></td>
                    <td th:text="${l.materialsInfo.unit}" id="unit"></td>
                    <!-- 날짜형태로 받을 수 있게 설정해야함 th:datetime -->
                    <td th:text="${l.materialOrderCode}"></td>
                    <td> 
                      <button type="button" class="btn btn-success btn-xs" onclick="location.href='addInWarehousing'" style="padding-right: 5px;"><i class="fa fa-plus-square"></i></button>
                      <button type="button" class="btn btn-danger btn-xs" onclick="location.href='addExWarehousing'"><i class="fa fa-minus-square"></i></button>
                    </td>
                    <td>
                    	<a th:if="${l.transactionCate == '입고'}" th:href="@{/rawMaterials/modifyInWarehousing(materialsCode=${l.materialCode}
                    	,materialsInAmount=${l.transactionAmount}
                    	,materialsName=${l.materialsInfo.rawMaterialName}
                    	,materialOrderCode=${l.materialOrderCode}
                    	,transactionDate=${l.transactionDate})}" class="btn btn-primary btn-xs" id="modifyBtn"><i class="fa fa-pencil"></i>수정</a>
                    	<a th:if="${l.transactionCate == '출고'}" th:href="@{/rawMaterials/modifyExWarehousing(materialsCode=${l.materialCode},materialsInAmount=${l.transactionAmount})}" class="btn btn-primary btn-xs" id="modifyBtn"><i class="fa fa-pencil"></i>수정</a>

                    </td>
                  </tr>
                </tbody>
              </table>
            
		       
       		</div>
       		
          </div>
          <!-- /col-md-12 -->
      
        
</th:block>

</html>